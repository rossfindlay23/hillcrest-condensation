<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hillcrest Property Team – Condensation Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <style>
    :root {
      --hc-blue: #009fdf;   /* light Hillcrest blue */
      --hc-navy: #003b5c;   /* dark navy */
      --hc-light: #e7f4fb;  /* pale blue background */
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #222;
      font-size: 15px; /* slightly smaller, inputs still big enough to stop zoom */
    }

    .page {
      width: 100%;
      margin: 0;
      padding: 0 12px 20px;
      box-sizing: border-box;
    }

    header {
      background: var(--hc-navy);
      color: white;
      padding: 14px 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      margin-bottom: 12px;
    }

    header img {
      height: 40px;
      width: auto;
      object-fit: contain;
      background: transparent;
    }

    header .title-block {
      display: flex;
      flex-direction: column;
    }

    header h1 {
      font-size: 18px;
      margin: 0;
      line-height: 1.2;
    }

    header span {
      font-size: 11px;
      opacity: 0.9;
    }

    .title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 10px;
    }

    h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
      color: var(--hc-navy);
    }

    label {
      display: block;
      margin-top: 0.8em;
      font-size: 14px;
      color: #333;
    }

    select {
      width: 100%;
      padding: 10px 10px;
      margin-top: 0.4em;
      box-sizing: border-box;
      border-radius: 6px;
      border: 1px solid #bbb;
      font-size: 17px;  /* large enough to stop zoom */
      -webkit-appearance: none;
      background-color: #fff;
    }

    .note {
      font-size: 12px;
      color: #555;
      margin-top: 6px;
    }

    .card {
      margin-top: 12px;
      padding: 14px 12px;
      border-radius: 8px;
      border: 1px solid #c3dff0;
      background: #ffffff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }

    .card-header {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 6px;
      color: var(--hc-navy);
    }

    .result-line {
      margin: 4px 0;
      font-size: 14px;
    }

    .big {
      font-weight: 600;
      font-size: 15px;
      color: var(--hc-navy);
    }

    .warning {
      color: #b00020;
      margin-top: 6px;
      font-size: 13px;
    }

    .tenant-text {
      margin-top: 8px;
      padding-top: 6px;
      border-top: 1px dashed #c3dff0;
      font-size: 12px;
      color: #444;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      margin-bottom: 2px;
    }

    .btn {
      flex-grow: 1;
      text-align: center;
      padding: 8px 6px;
      border-radius: 6px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
    }

    .btn-primary {
      background: var(--hc-blue);
      color: #fff;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid #c3dff0;
      color: var(--hc-navy);
    }

    .btn:active {
      opacity: 0.8;
    }

    .info-inline {
      flex-grow: 0;
      padding: 6px 8px;
      font-size: 12px;
    }

    #staffInfo {
      margin-top: 8px;
      display: none;
    }

    footer {
      text-align: center;
      font-size: 10px;
      color: #777;
      padding: 6px 0 4px;
    }
  </style>
</head>

<body>
  <header>
    <!-- Uses the logo file in your repo -->
    <img src="hillcrest-logo.jpg" alt="Hillcrest Homes logo">
    <div class="title-block">
      <h1>Hillcrest Property Team</h1>
      <span>Condensation Calculator &amp; Heating Helper</span>
    </div>
  </header>

  <div class="page">
    <div class="title-row">
      <h2>Condensation Calculator</h2>
      <button class="btn btn-outline info-inline" type="button" onclick="toggleStaffInfo()">
        ℹ️ Staff guidance
      </button>
    </div>

    <p class="note">
      For Hillcrest Property staff use on visits. Select the current room temperature and
      relative humidity. The tool estimates the dew point and the temperature needed
      (if no extra moisture is added or removed) to reach your target RH.
    </p>

    <div id="staffInfo" class="card">
      <div class="card-header">Quick staff guidance</div>
      <div class="result-line">
        1. Take a reading of room temperature and relative humidity (ideally at breathing height, away from windows).
      </div>
      <div class="result-line">
        2. Use the drop-downs below to select the nearest values. Keep the target RH at 60% unless there is a clear reason to change it.
      </div>
      <div class="result-line">
        3. Use the “Required temperature” result to discuss realistic heating settings with the tenant.
      </div>
      <div class="result-line">
        4. If the required temperature is high, also stress ventilation and moisture reduction:
        lids on pans, using extract fans, avoiding drying clothes in small unventilated rooms, etc.
      </div>
      <div class="result-line">
        5. The “RH at 20°C” gives a quick sense of whether simply heating to 20°C will be enough or
        whether extra drying/ventilation is still needed.
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-primary" type="button" onclick="resetForm()">
        Reset / clear values
      </button>
    </div>

    <label>
      Current temperature (°C)
      <select id="temp">
        <option value="">Select temperature…</option>
        <!-- 10–25 °C in 0.5 °C steps -->
        <option value="10">10.0</option>
        <option value="10.5">10.5</option>
        <option value="11">11.0</option>
        <option value="11.5">11.5</option>
        <option value="12">12.0</option>
        <option value="12.5">12.5</option>
        <option value="13">13.0</option>
        <option value="13.5">13.5</option>
        <option value="14">14.0</option>
        <option value="14.5">14.5</option>
        <option value="15">15.0</option>
        <option value="15.5">15.5</option>
        <option value="16">16.0</option>
        <option value="16.5">16.5</option>
        <option value="17">17.0</option>
        <option value="17.5">17.5</option>
        <option value="18">18.0</option>
        <option value="18.5">18.5</option>
        <option value="19">19.0</option>
        <option value="19.5">19.5</option>
        <option value="20">20.0</option>
        <option value="20.5">20.5</option>
        <option value="21">21.0</option>
        <option value="21.5">21.5</option>
        <option value="22">22.0</option>
        <option value="22.5">22.5</option>
        <option value="23">23.0</option>
        <option value="23.5">23.5</option>
        <option value="24">24.0</option>
        <option value="24.5">24.5</option>
        <option value="25">25.0</option>
      </select>
    </label>

    <label>
      Current relative humidity (%)
      <select id="rh">
        <option value="">Select RH…</option>
        <!-- 40–90% in 5% steps -->
        <option value="40">40%</option>
        <option value="45">45%</option>
        <option value="50">50%</option>
        <option value="55">55%</option>
        <option value="60">60%</option>
        <option value="65">65%</option>
        <option value="70">70%</option>
        <option value="75">75%</option>
        <option value="80">80%</option>
        <option value="85">85%</option>
        <option value="90">90%</option>
      </select>
    </label>

    <label>
      Target relative humidity (%)
      <span class="note">(Default 60%. Only change if agreed as part of advice.)</span>
      <select id="targetRh">
        <option value="55">55%</option>
        <option value="60" selected>60%</option>
        <option value="65">65%</option>
        <option value="70">70%</option>
      </select>
    </label>

    <div id="warning" class="warning"></div>

    <div class="card">
      <div class="card-header">Results for this room</div>

      <div class="result-line big">
        Dew point:&nbsp;<span id="dewpoint">–</span>&nbsp;°C
      </div>

      <div class="result-line big">
        Required temp to reach target RH:&nbsp;
        <span id="requiredTemp">–</span>&nbsp;°C
      </div>

      <div class="result-line">
        Estimated RH if heated to 20&nbsp;°C (no extra moisture removed):&nbsp;
        <span id="rhAt20">–</span>&nbsp;%
      </div>

      <div class="tenant-text" id="tenantText">
        Once you select the values above, a simple explanation to use with the tenant
        will appear here.
      </div>
    </div>

    <p class="note" style="margin-top:8px;">
      Assumes the amount of moisture in the air stays the same (no extra drying or moisture added).
      Based on standard psychrometric relationships (same principle as the training chart).
    </p>
  </div>

  <footer>
    Hillcrest Homes – Property Team • Condensation &amp; Heating Guidance Tool
  </footer>

  <script>
    // Saturation vapour pressure (kPa) over water – Tetens formula
    function satVapPressure(T) {
      return 0.6108 * Math.exp((17.27 * T) / (T + 237.3));
    }

    // Inverse of Tetens: from saturation vapour pressure (kPa) to temperature (°C)
    function tempFromSatVapPressure(es) {
      const lnTerm = Math.log(es / 0.6108);
      return (237.3 * lnTerm) / (17.27 - lnTerm);
    }

    function toNum(v) {
      const n = parseFloat(v);
      return isNaN(n) ? null : n;
    }

    function calc() {
      const t = toNum(document.getElementById("temp").value);
      const rh = toNum(document.getElementById("rh").value);
      const targetRh = toNum(document.getElementById("targetRh").value);

      const warningEl = document.getElementById("warning");
      const dewEl = document.getElementById("dewpoint");
      const reqEl = document.getElementById("requiredTemp");
      const rh20El = document.getElementById("rhAt20");
      const tenantEl = document.getElementById("tenantText");

      warningEl.textContent = "";
      dewEl.textContent = "–";
      reqEl.textContent = "–";
      rh20El.textContent = "–";
      tenantEl.textContent =
        "Once you select the values above, a simple explanation to use with the tenant will appear here.";

      if (t === null || rh === null || targetRh === null) return;

      if (rh <= 0 || rh > 100 || targetRh <= 0 || targetRh > 100) {
        warningEl.textContent = "RH values must be between 1% and 100%.";
        return;
      }

      const es = satVapPressure(t);
      const e = (rh / 100) * es;

      const dewpoint = tempFromSatVapPressure(e);

      const esReq = e * (100 / targetRh);
      const requiredTemp = tempFromSatVapPressure(esReq);

      const es20 = satVapPressure(20);
      const rhAt20 = (e / es20) * 100;

      if (isFinite(dewpoint)) dewEl.textContent = dewpoint.toFixed(1);
      if (isFinite(requiredTemp)) reqEl.textContent = requiredTemp.toFixed(1);
      if (isFinite(rhAt20)) rh20El.textContent = rhAt20.toFixed(0);

      if (isFinite(requiredTemp) && isFinite(rhAt20)) {
        tenantEl.textContent =
          "Based on a current temperature of " + t.toFixed(1) + "°C at about " +
          rh.toFixed(0) + "% humidity, heating the room to around " +
          requiredTemp.toFixed(1) + "°C would bring the humidity down towards " +
          targetRh.toFixed(0) + "%. If it was only heated to 20°C, the humidity would be roughly " +
          rhAt20.toFixed(0) +
          "%, so extra ventilation or reducing moisture (for example, lids on pans, drying clothes in a ventilated room, using extract fans) will still help.";
      }
    }

    function resetForm() {
      document.getElementById("temp").value = "";
      document.getElementById("rh").value = "";
      document.getElementById("targetRh").value = "60";
      calc();
    }

    function toggleStaffInfo() {
      const el = document.getElementById("staffInfo");
      el.style.display = (el.style.display === "none" || el.style.display === "") ? "block" : "none";
    }

    document.addEventListener("input", function (e) {
      if (e.target.matches("select")) calc();
    });

    document.addEventListener("change", function (e) {
      if (e.target.matches("select")) calc();
    });

    // Initial state (no values selected)
    calc();
  </script>
</body>
</html>