<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hillcrest Property Team – Condensation Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <style>
    :root {
      --hc-blue: #009fdf;   /* light Hillcrest blue */
      --hc-navy: #003b5c;   /* dark navy */
      --hc-light: #e7f4fb;  /* pale blue background */
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #222;
      font-size: 16px; /* base size – stops iPhone zooming */
    }

    .page {
      width: 100%;
      margin: 0;
      padding: 0 14px 40px;
      box-sizing: border-box;
    }

    header {
      background: var(--hc-navy);
      color: white;
      padding: 18px 18px;
      display: flex;
      align-items: center;
      gap: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      margin-bottom: 20px;
    }

    header img {
      height: 45px;
      width: auto;
      object-fit: contain;
      background: transparent;
    }

    header .title-block {
      display: flex;
      flex-direction: column;
    }

    header h1 {
      font-size: 19px;
      margin: 0;
      line-height: 1.2;
    }

    header span {
      font-size: 12px;
      opacity: 0.9;
    }

    h2 {
      margin-top: 16px;
      font-size: 22px;
      font-weight: 700;
      color: var(--hc-navy);
    }

    label {
      display: block;
      margin-top: 1em;
      font-size: 15px;
      color: #333;
    }

    input[type="number"] {
      width: 100%;
      padding: 12px 12px;
      margin-top: 0.5em;
      box-sizing: border-box;
      border-radius: 6px;
      border: 1px solid #bbb;
      font-size: 18px;  /* large enough to stop zoom */
      -webkit-appearance: none;
    }

    .note {
      font-size: 13px;
      color: #555;
    }

    .card {
      margin-top: 18px;
      padding: 18px 16px;
      border-radius: 10px;
      border: 1px solid #c3dff0;
      background: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.06);
    }

    .card-header {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 8px;
      color: var(--hc-navy);
    }

    .result-line {
      margin: 6px 0;
      font-size: 15px;
    }

    .big {
      font-weight: 600;
      font-size: 16px;
      color: var(--hc-navy);
    }

    .warning {
      color: #b00020;
      margin-top: 8px;
      font-size: 14px;
    }

    .tenant-text {
      margin-top: 12px;
      padding-top: 8px;
      border-top: 1px dashed #c3dff0;
      font-size: 13px;
      color: #444;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
      margin-bottom: 4px;
    }

    .btn {
      flex-grow: 1;
      text-align: center;
      padding: 10px 8px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }

    .btn-primary {
      background: var(--hc-blue);
      color: #fff;
    }

    .btn-secondary {
      background: #e0e7ec;
      color: #123;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid #c3dff0;
      color: var(--hc-navy);
    }

    .btn:active {
      opacity: 0.8;
    }

    .info-toggle {
      margin-top: 6px;
      text-align: right;
    }

    .info-toggle button {
      font-size: 13px;
      padding: 6px 10px;
    }

    #staffInfo {
      margin-top: 10px;
      display: none;
    }

    footer {
      text-align: center;
      font-size: 11px;
      color: #777;
      padding: 10px 0 4px;
    }
  </style>
</head>

<body>
  <header>
    <!-- Uses the logo file in your repo -->
    <img src="hillcrest-logo.jpg" alt="Hillcrest Homes logo">
    <div class="title-block">
      <h1>Hillcrest Property Team</h1>
      <span>Condensation Calculator &amp; Heating Helper</span>
    </div>
  </header>

  <div class="page">
    <h2>Condensation Calculator</h2>
    <p class="note">
      For Hillcrest Property staff use on visits. Enter the current room temperature and
      relative humidity. The tool estimates the dew point and the temperature needed
      (if no extra moisture is added or removed) to reach your target RH.
    </p>

    <div class="info-toggle">
      <button class="btn btn-outline" type="button" onclick="toggleStaffInfo()">
        ℹ️ Staff guidance
      </button>
    </div>

    <div id="staffInfo" class="card">
      <div class="card-header">Quick staff guidance</div>
      <div class="result-line">
        1. Take a reading of room temperature and relative humidity (ideally at breathing height, away from windows).
      </div>
      <div class="result-line">
        2. Enter the values below and choose a target RH (60–65% is a good comfort and mould-prevention level).
      </div>
      <div class="result-line">
        3. Use the “Required temperature” result to discuss realistic heating settings with the tenant.
      </div>
      <div class="result-line">
        4. If the required temperature is high, also stress ventilation and moisture reduction:
        lids on pans, using extract fans, avoiding drying clothes in small unventilated rooms, etc.
      </div>
      <div class="result-line">
        5. The “RH at 20°C” gives a quick sense of whether simply heating to 20°C will be enough or
        whether extra drying/ventilation is still needed.
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-secondary" type="button" onclick="setPreset(16, 80, 60)">
        Preset 1: 16°C / 80% → 60%
      </button>
      <button class="btn btn-secondary" type="button" onclick="setPreset(18, 75, 60)">
        Preset 2: 18°C / 75% → 60%
      </button>
    </div>

    <div class="btn-row">
      <button class="btn btn-primary" type="button" onclick="resetForm()">
        Reset / clear values
      </button>
    </div>

    <label>
      Current temperature (°C)
      <input type="number" id="temp" step="0.1" value="16">
    </label>

    <label>
      Current relative humidity (%)
      <input type="number" id="rh" step="1" value="80">
    </label>

    <label>
      Target relative humidity (%)
      <span class="note">(60–65% is a typical comfort / mould-prevention level)</span>
      <input type="number" id="targetRh" step="1" value="60">
    </label>

    <div id="warning" class="warning"></div>

    <div class="card">
      <div class="card-header">Results for this room</div>

      <div class="result-line big">
        Dew point:&nbsp;<span id="dewpoint">–</span>&nbsp;°C
      </div>

      <div class="result-line big">
        Required temp to reach target RH:&nbsp;
        <span id="requiredTemp">–</span>&nbsp;°C
      </div>

      <div class="result-line">
        Estimated RH if heated to 20&nbsp;°C (no extra moisture removed):&nbsp;
        <span id="rhAt20">–</span>&nbsp;%
      </div>

      <div class="tenant-text" id="tenantText">
        Once you enter the values above, a simple explanation to use with the tenant
        will appear here.
      </div>
    </div>

    <p class="note" style="margin-top:12px;">
      Assumes the amount of moisture in the air stays the same (no extra drying or moisture added).
      Based on standard psychrometric relationships (same principle as the training chart).
    </p>
  </div>

  <footer>
    Hillcrest Homes – Property Team • Condensation &amp; Heating Guidance Tool
  </footer>

  <script>
    // Saturation vapour pressure (kPa) over water – Tetens formula
    function satVapPressure(T) {
      return 0.6108 * Math.exp((17.27 * T) / (T + 237.3));
    }

    // Inverse of Tetens: from saturation vapour pressure (kPa) to temperature (°C)
    function tempFromSatVapPressure(es) {
      const lnTerm = Math.log(es / 0.6108);
      return (237.3 * lnTerm) / (17.27 - lnTerm);
    }

    function toNum(v) {
      const n = parseFloat(v);
      return isNaN(n) ? null : n;
    }

    function calc() {
      const t = toNum(document.getElementById("temp").value);
      const rh = toNum(document.getElementById("rh").value);
      const targetRh = toNum(document.getElementById("targetRh").value);

      const warningEl = document.getElementById("warning");
      const dewEl = document.getElementById("dewpoint");
      const reqEl = document.getElementById("requiredTemp");
      const rh20El = document.getElementById("rhAt20");
      const tenantEl = document.getElementById("tenantText");

      warningEl.textContent = "";
      dewEl.textContent = "–";
      reqEl.textContent = "–";
      rh20El.textContent = "–";
      tenantEl.textContent =
        "Once you enter the values above, a simple explanation to use with the tenant will appear here.";

      if (t === null || rh === null || targetRh === null) return;

      if (rh <= 0 || rh > 100 || targetRh <= 0 || targetRh > 100) {
        warningEl.textContent = "RH values must be between 1% and 100%.";
        return;
      }

      const es = satVapPressure(t);
      const e = (rh / 100) * es;

      const dewpoint = tempFromSatVapPressure(e);

      const esReq = e * (100 / targetRh);
      const requiredTemp = tempFromSatVapPressure(esReq);

      const es20 = satVapPressure(20);
      const rhAt20 = (e / es20) * 100;

      if (isFinite(dewpoint)) dewEl.textContent = dewpoint.toFixed(1);
      if (isFinite(requiredTemp)) reqEl.textContent = requiredTemp.toFixed(1);
      if (isFinite(rhAt20)) rh20El.textContent = rhAt20.toFixed(0);

      if (isFinite(requiredTemp) && isFinite(rhAt20)) {
        tenantEl.textContent =
          "Based on a current temperature of " + t.toFixed(1) + "°C at about " +
          rh.toFixed(0) + "% humidity, heating the room to around " +
          requiredTemp.toFixed(1) + "°C would bring the humidity down towards " +
          targetRh.toFixed(0) + "%. If it was only heated to 20°C, the humidity would be roughly " +
          rhAt20.toFixed(0) +
          "%, so extra ventilation or reducing moisture (for example, lids on pans, drying clothes in a ventilated room, using extract fans) will still help.";
      }
    }

    function setPreset(t, rh, targetRh) {
      document.getElementById("temp").value = t;
      document.getElementById("rh").value = rh;
      document.getElementById("targetRh").value = targetRh;
      calc();
    }

    function resetForm() {
      document.getElementById("temp").value = "";
      document.getElementById("rh").value = "";
      document.getElementById("targetRh").value = 60;
      calc();
    }

    function toggleStaffInfo() {
      const el = document.getElementById("staffInfo");
      el.style.display = (el.style.display === "none" || el.style.display === "") ? "block" : "none";
    }

    document.addEventListener("input", function (e) {
      if (e.target.matches("input")) calc();
    });

    // Initial calculation with defaults
    calc();
  </script>
</body>
</html>