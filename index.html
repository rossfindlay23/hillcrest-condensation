<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hillcrest Property Team – Condensation Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <style>
    :root {
      --hc-blue: #009fdf;   /* light Hillcrest blue */
      --hc-navy: #003b5c;   /* dark navy */
      --hc-light: #e7f4fb;  /* pale blue background */
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #222;
      font-size: 16px; /* base size – stops iPhone zooming */
    }

    .page {
      width: 100%;
      margin: 0;
      padding: 0 14px 30px;
      box-sizing: border-box;
    }

    header {
      background: var(--hc-navy);
      color: white;
      padding: 18px 18px;
      display: flex;
      align-items: center;
      gap: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      margin-bottom: 20px;
    }

    header img {
      height: 45px;
      width: auto;
      object-fit: contain;
      background: transparent;
    }

    header .title-block {
      display: flex;
      flex-direction: column;
    }

    header h1 {
      font-size: 19px;
      margin: 0;
      line-height: 1.2;
    }

    header span {
      font-size: 12px;
      opacity: 0.9;
    }

    h2 {
      margin-top: 16px;
      font-size: 22px;
      font-weight: 700;
      color: var(--hc-navy);
    }

    label {
      display: block;
      margin-top: 1em;
      font-size: 15px;
      color: #333;
    }

    input[type="number"] {
      width: 100%;
      padding: 12px 12px;
      margin-top: 0.5em;
      box-sizing: border-box;
      border-radius: 6px;
      border: 1px solid #bbb;
      font-size: 18px;  /* large enough to stop zoom */
      -webkit-appearance: none;
    }

    .note {
      font-size: 13px;
      color: #555;
    }

    .card {
      margin-top: 18px;
      padding: 18px 16px;
      border-radius: 10px;
      border: 1px solid #c3dff0;
      background: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.06);
    }

    .card-header {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 8px;
      color: var(--hc-navy);
    }

    .result-line {
      margin: 6px 0;
      font-size: 15px;
    }

    .big {
      font-weight: 600;
      font-size: 16px;
      color: var(--hc-navy);
    }

    .warning {
      color: #b00020;
      margin-top: 8px;
      font-size: 14px;
    }

    .tenant-text {
      margin-top: 12px;
      padding-top: 8px;
      border-top: 1px dashed #c3dff0;
      font-size: 13px;
      color: #444;
    }
  </style>
</head>

<body>
  <header>
    <!-- Uses the logo file in your repo -->
    <img src="hillcrest-logo.jpg.jpg" alt="Hillcrest Homes logo">
    <div class="title-block">
      <h1>Hillcrest Property Team</h1>
      <span>Condensation Calculator &amp; Heating Helper</span>
    </div>
  </header>

  <div class="page">
    <h2>Condensation Calculator</h2>
    <p class="note">
      For Hillcrest Property staff use on visits. Enter the current room temperature and
      relative humidity. The tool estimates the dew point and the temperature needed
      (if no extra moisture is added or removed) to reach your target RH.
    </p>

    <label>
      Current temperature (°C)
      <input type="number" id="temp" step="0.1" value="16">
    </label>

    <label>
      Current relative humidity (%)
      <input type="number" id="rh" step="1" value="80">
    </label>

    <label>
      Target relative humidity (%)
      <span class="note">(60–65% is a typical comfort / mould-prevention level)</span>
      <input type="number" id="targetRh" step="1" value="60">
    </label>

    <div id="warning" class="warning"></div>

    <div class="card">
      <div class="card-header">Results for this room</div>

      <div class="result-line big">
        Dew point:&nbsp;<span id="dewpoint">–</span>&nbsp;°C
      </div>

      <div class="result-line big">
        Required temp to reach target RH:&nbsp;
        <span id="requiredTemp">–</span>&nbsp;°C
      </div>

      <div class="result-line">
        Estimated RH if heated to 20&nbsp;°C (no extra moisture removed):&nbsp;
        <span id="rhAt20">–</span>&nbsp;%
      </div>

      <div class="tenant-text" id="tenantText">
        Once you enter the values above, a simple explanation to use with the tenant
        will appear here.
      </div>
    </div>

    <p class="note" style="margin-top:12px;">
      Assumes the amount of moisture in the air stays the same (no extra drying or moisture added).
      Based on standard psychrometric relationships (same principle as the training chart).
    </p>
  </div>

  <script>
    // Saturation vapour pressure (kPa) over water – Tetens formula
    function satVapPressure(T) {
      return 0.6108 * Math.exp((17.27 * T) / (T + 237.3));
    }

    // Inverse of Tetens: from saturation vapour pressure (kPa) to temperature (°C)
    function tempFromSatVapPressure(es) {
      const lnTerm = Math.log(es / 0.6108);
      return (237.3 * lnTerm) / (17.27 - lnTerm);
    }

    function toNum(v) {
      const n = parseFloat(v);
      return isNaN(n) ? null : n;
    }

    function calc() {
      const t = toNum(document.getElementById("temp").value);
      const rh = toNum(document.getElementById("rh").value);
      const targetRh = toNum(document.getElementById("targetRh").value);

      const warningEl = document.getElementById("warning");
      const dewEl = document.getElementById("dewpoint");
      const reqEl = document.getElementById("requiredTemp");
      const rh20El = document.getElementById("rhAt20");
      const tenantEl = document.getElementById("tenantText");

      warningEl.textContent = "";
      dewEl.textContent = "–";
      reqEl.textContent = "–";
      rh20El.textContent = "–";
      tenantEl.textContent =
        "Once you enter the values above, a simple explanation to use with the tenant will appear here.";

      if (t === null || rh === null || targetRh === null) return;

      if (rh <= 0 || rh > 100 || targetRh <= 0 || targetRh > 100) {
        warningEl.textContent = "RH values must be between 1% and 100%.";
        return;
      }

      // Current saturation vapour pressure at temperature t
      const es = satVapPressure(t);
      // Actual vapour pressure (kPa)
      const e = (rh / 100) * es;

      // Dew point: where RH would be 100% with same vapour pressure
      const dewpoint = tempFromSatVapPressure(e);

      // Required temp so that RH = targetRh with same vapour pressure
      const esReq = e * (100 / targetRh);
      const requiredTemp = tempFromSatVapPressure(esReq);

      // RH at 20°C with same moisture (handy reference)
      const es20 = satVapPressure(20);
      const rhAt20 = (e / es20) * 100;

      if (isFinite(dewpoint)) dewEl.textContent = dewpoint.toFixed(1);
      if (isFinite(requiredTemp)) reqEl.textContent = requiredTemp.toFixed(1);
      if (isFinite(rhAt20)) rh20El.textContent = rhAt20.toFixed(0);

      if (isFinite(requiredTemp) && isFinite(rhAt20)) {
        tenantEl.textContent =
          "Based on a current temperature of " + t.toFixed(1) + "°C at about " +
          rh.toFixed(0) + "% humidity, heating the room to around " +
          requiredTemp.toFixed(1) + "°C would bring the humidity down towards " +
          targetRh.toFixed(0) + "%. If it was only heated to 20°C, the humidity would be roughly " +
          rhAt20.toFixed(0) +
          "%, so extra ventilation or reducing moisture (for example, lids on pans, drying clothes in a ventilated room, using extract fans) will still help.";
      }
    }

    document.addEventListener("input", function (e) {
      if (e.target.matches("input")) calc();
    });

    // Initial calculation with defaults
    calc();
  </script>
</body>
</html>